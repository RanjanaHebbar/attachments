sap.ui.define(["sap/fe/core/PageController"],function(e){"use strict";return e.extend("attachmentapp.ext.main.Main",{onInit:function(){},onAfterItemAdded:function(e){var t=e.getParameter("item");this._createEntity(t).then(e=>{this._uploadContent(t,e)}).catch(e=>{console.log(e)})},onUploadCompleted:function(e){var t=this.byId("uploadSet");t.removeAllIncompleteItems();t.getBinding("items").refresh()},onOpenPressed:function(e){},_createEntity:function(e){var t={mediaType:e.getMediaType(),fileName:e.getFileName(),size:e.getFileObject().size};var n={url:"/odata/v4/attachments/Files",method:"POST",headers:{"Content-type":"application/json"},data:JSON.stringify(t)};return new Promise((e,t)=>{$.ajax(n).done((t,n,a)=>{e(t.ID)}).fail(e=>{t(e)})})},_uploadContent:function(e,t){var n=`/odata/v4/attachments/Files(${t})/content`;e.setUploadUrl(n);var a=this.byId("uploadSet");a.setHttpRequestMethod("PUT");a.uploadItem(e)}})});